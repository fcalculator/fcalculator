<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day and Night Earth Visualizer</title>
    <link rel="stylesheet" href="https://fcalculator.com/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <div class="logo">FCalculator.com</div>
        <h1>Live Day and Night Earth Visualizer</h1>
        <p>Experience a real-time visualization of sunlight distribution across the Earth's surface, highlighting regions in daylight and those enveloped in night. This dynamic tool uses astronomical calculations to map the terminator line—the boundary between day and night—based on current UTC time, providing an accurate representation of global illumination patterns as they occur.</p>
    </header>

    <div class="tool">
        <label for="datetime">Select Date and Time (UTC):</label>
        <input type="datetime-local" id="datetime">
        <button onclick="calculate(false)">Visualize</button>
        <label for="live">Live Update:</label>
        <input type="checkbox" id="live" checked onchange="toggleLive()">
        <canvas id="earthMap" width="940" height="477" style="border:1px solid #ccc; display:block; margin:20px auto;"></canvas>
        <div id="results" class="result"></div>
        <canvas id="declinationChart" width="600" height="300" style="display:block; margin:20px auto;"></canvas>
    </div>

    <div class="content">
        <h2>Understanding the Dynamics of Day and Night on Earth</h2>
        <p>The Earth's rotation creates a continuous cycle of day and night, with the subsolar point indicating where the Sun is directly overhead at any moment. This point migrates due to the planet's 23.45-degree axial tilt, influencing seasonal changes in daylight duration. Our live visualizer employs precise formulas to render these patterns in real-time, offering insights into how solar positions affect weather, ecosystems, and human activities worldwide.</p>
        
        <h3>Astronomical Formulas for Real-Time Mapping</h3>
        <p>The solar declination (δ) is calculated as δ = 23.45 × sin(2π / 365 × (d - 81)), where d represents the day of the year. Longitude adjustments are made based on current UTC time: longitude = 15 × (hour - 12). For the Moon's position, approximations account for its orbital tilt of 5.14 degrees. The terminator line is determined by the solar zenith angle, where cos(z) = sin(φ)sin(δ) + cos(φ)cos(δ)cos(H), with φ as latitude and H as the hour angle. Regions where cos(z) < 0 are shaded as night, providing a scientifically accurate boundary.</p>
        
        <p>The ground speed of the subsolar point averages 446 m/s at the equator, decreasing towards the poles. This visualization updates automatically to reflect these movements, simulating the Earth's rotation and orbital mechanics in a user-friendly interface.</p>
        
        <h3>Seasonal Impacts and Global Variations</h3>
        <p>Equinoxes bring equal day and night lengths globally, while solstices create extremes in polar regions. For instance, the June solstice extends daylight in the Northern Hemisphere, potentially leading to midnight sun phenomena above the Arctic Circle. Our tool captures these variations live, including twilight zones that extend usable light beyond strict sunrise and sunset times.</p>
        
        <table>
            <thead>
                <tr>
                    <th>Seasonal Event</th>
                    <th>Typical Date</th>
                    <th>Key Characteristics</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Vernal Equinox</td>
                    <td>March 20-21</td>
                    <td>Sun directly over equator; equal day/night</td>
                </tr>
                <tr>
                    <td>Summer Solstice</td>
                    <td>June 20-21</td>
                    <td>Maximum tilt towards Sun; longest Northern daylight</td>
                </tr>
                <tr>
                    <td>Autumnal Equinox</td>
                    <td>September 22-23</td>
                    <td>Sun over equator again; balanced illumination</td>
                </tr>
                <tr>
                    <td>Winter Solstice</td>
                    <td>December 21-22</td>
                    <td>Maximum tilt away; longest Southern daylight</td>
                </tr>
            </tbody>
        </table>
        
        <p>Twilight classifications—civil (Sun 0-6° below horizon), nautical (6-12°), and astronomical (12-18°)—are crucial for activities like aviation and astronomy. While our map focuses on the primary day-night divide, these extensions can add up to hours of dim light, varying by latitude and season.</p>
        
        <button onclick="sharePage()">Share this Visualizer</button>
        
        <h3>Practical Applications and Educational Value</h3>
        <p>This live visualizer serves meteorologists forecasting weather patterns influenced by solar heating, satellite operators aligning with illuminated areas, and educators demonstrating planetary motion. Coordinate with time zone differences using our <a href="/time-zone-calculator.html">Time Zone Calculator</a> or precise time computations via the <a href="/time.html">Time Calculator</a> for international planning.</p>
        
        <p>Explore further through authoritative sources such as NASA's solar system data or NOAA's geophysical models, linked in the resources section below for in-depth study.</p>
    </div>

    <section class="related-resources">
        <h2>Related Resources</h2>
        <ul>
            <li><a href="https://en.wikipedia.org/wiki/Subsolar_point" target="_blank" rel="noopener noreferrer">Wikipedia - Subsolar Point and Solar Positions</a></li>
            <li><a href="https://en.wikipedia.org/wiki/Terminator_(solar)" target="_blank" rel="noopener noreferrer">Wikipedia - Day-Night Terminator Line</a></li>
            <li><a href="https://gml.noaa.gov/grad/solcalc/" target="_blank" rel="noopener noreferrer">NOAA Global Monitoring Laboratory Solar Calculator</a></li>
            <li><a href="https://earthobservatory.nasa.gov/" target="_blank" rel="noopener noreferrer">NASA Earth Observatory</a></li>
            <li><a href="https://www.timeanddate.com/astronomy/" target="_blank" rel="noopener noreferrer">Time and Date Astronomy Section</a></li>
        </ul>
    </section>

	<footer>
        Project created by Ivan Brkic. Project launched in 2020. Version 1.02
        <a href="/sitemap.html">sitemap</a> <a href="/about.html">about us</a> <a href="/contact.html">contact us</a> <a href="/terms.html">terms of use</a> <a href="/privacy.html">privacy policy</a>
    </footer>

    <img id="worldMapImg" src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/BlankMap-World-Equirectangular.svg/940px-BlankMap-World-Equirectangular.svg.png" style="display:none;">

    <script>
        let intervalId = null;
        const mapWidth = 940;
        const mapHeight = 477;

        function getDayOfYear(date) {
            const start = new Date(date.getFullYear(), 0, 0);
            const diff = (date - start) + ((start.getTimezoneOffset() - date.getTimezoneOffset()) / 60 * 1000);
            return Math.floor(diff / 86400000);
        }

        function toggleLive() {
            if (document.getElementById('live').checked) {
                calculate(true);
                intervalId = setInterval(() => calculate(true), 60000);
            } else {
                if (intervalId) clearInterval(intervalId);
            }
        }

        function calculate(useCurrent = false) {
            let date;
            if (useCurrent) {
                date = new Date();
            } else {
                const datetimeInput = document.getElementById('datetime').value;
                if (!datetimeInput) return;
                date = new Date(datetimeInput + 'Z');
            }
            const dayOfYear = getDayOfYear(date);
            const declination = 23.45 * Math.sin((2 * Math.PI / 365) * (dayOfYear - 81));
            const hour = date.getUTCHours() + date.getUTCMinutes() / 60 + date.getUTCSeconds() / 3600;
            let subsolarLon = 15 * (hour - 12);
            subsolarLon = (subsolarLon + 180) % 360 - 180;
            const subsolarLat = declination;

            // Approximate sublunar
            const moonDeclination = 23.45 * Math.sin((2 * Math.PI / 365) * (dayOfYear - 81 + 10));
            let sublunarLon = subsolarLon + 180;
            sublunarLon = (sublunarLon + 180) % 360 - 180;
            const sublunarLat = moonDeclination;

            const sunSpeed = 446.05;
            const moonSpeed = 414.29;

            // Results
            let resultsHtml = `
                <p class="green">Selected Time: ${date.toUTCString()}</p>
                <p class="green">Subsolar Point: Latitude ${subsolarLat.toFixed(2)}°${subsolarLat >= 0 ? 'N' : 'S'}, Longitude ${subsolarLon.toFixed(2)}°${subsolarLon >= 0 ? 'E' : 'W'}</p>
                <p class="green">Sublunar Point: Latitude ${sublunarLat.toFixed(2)}°${sublunarLat >= 0 ? 'N' : 'S'}, Longitude ${sublunarLon.toFixed(2)}°${sublunarLon >= 0 ? 'E' : 'W'}</p>
                <p class="green">Sun Ground Speed: ${sunSpeed} m/s</p>
                <p class="green">Moon Ground Speed: ${moonSpeed} m/s</p>
                <table>
                    <thead>
                        <tr><th>Parameter</th><th>Value</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>Solar Declination</td><td>${declination.toFixed(2)}°</td></tr>
                    </tbody>
                </table>
            `;
            document.getElementById('results').innerHTML = resultsHtml;

            // Draw map
            const canvas = document.getElementById('earthMap');
            const ctx = canvas.getContext('2d');
            const img = document.getElementById('worldMapImg');
            ctx.drawImage(img, 0, 0, mapWidth, mapHeight);

            // Apply night shade
            const imageData = ctx.getImageData(0, 0, mapWidth, mapHeight);
            const data = imageData.data;
            const degToRad = Math.PI / 180;
            const decRad = declination * degToRad;

            for (let y = 0; y < mapHeight; y++) {
                const lat = 90 - (y / mapHeight * 180);
                const latRad = lat * degToRad;
                const sinLat = Math.sin(latRad);
                const cosLat = Math.cos(latRad);

                for (let x = 0; x < mapWidth; x++) {
                    const lon = (x / mapWidth * 360) - 180;
                    const H = (lon - subsolarLon) * degToRad;
                    const cosZ = sinLat * Math.sin(decRad) + cosLat * Math.cos(decRad) * Math.cos(H);
                    const i = (y * mapWidth + x) * 4;

                    if (cosZ < 0) {
                        data[i] = Math.floor(data[i] * 0.3);     // Darken R
                        data[i + 1] = Math.floor(data[i + 1] * 0.3); // Darken G
                        data[i + 2] = Math.floor(data[i + 2] * 0.3); // Darken B
                    }
                }
            }
            ctx.putImageData(imageData, 0, 0);

            // Grid lines (optional, if wanted on top)
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 0.5;
            for (let i = 0; i <= mapWidth; i += mapWidth / 10) { ctx.beginPath(); ctx.moveTo(i, 0); ctx.lineTo(i, mapHeight); ctx.stroke(); }
            for (let i = 0; i <= mapHeight; i += mapHeight / 5) { ctx.beginPath(); ctx.moveTo(0, i); ctx.lineTo(mapWidth, i); ctx.stroke(); }

            // Sun red dot
            const sunX = (subsolarLon + 180) / 360 * mapWidth;
            const sunY = (90 - subsolarLat) / 180 * mapHeight;
            ctx.fillStyle = 'red';
            ctx.beginPath(); ctx.arc(sunX, sunY, 5, 0, 2 * Math.PI); ctx.fill();

            // Moon white dot
            const moonX = (sublunarLon + 180) / 360 * mapWidth;
            const moonY = (90 - sublunarLat) / 180 * mapHeight;
            ctx.fillStyle = 'white';
            ctx.beginPath(); ctx.arc(moonX, moonY, 5, 0, 2 * Math.PI); ctx.fill();

            // Declination chart
            const chartCtx = document.getElementById('declinationChart').getContext('2d');
            new Chart(chartCtx, {
                type: 'line',
                data: {
                    labels: Array.from({length: 365}, (_, i) => i + 1),
                    datasets: [{
                        label: 'Solar Declination Over the Year',
                        data: Array.from({length: 365}, (_, i) => 23.45 * Math.sin((2 * Math.PI / 365) * (i - 81))),
                        borderColor: 'green',
                        fill: false
                    }]
                },
                options: { scales: { y: { title: { display: true, text: 'Declination (°)' } } } }
            });
        }

        function sharePage() {
            if (navigator.share) {
                navigator.share({ title: 'Live Day and Night Earth Visualizer', url: window.location.href });
            } else {
                alert('Share not supported on this browser.');
            }
        }

        // Set initial datetime to current
        const now = new Date();
        document.getElementById('datetime').value = now.toISOString().slice(0, 16);

        // Wait for image load before initial calculate
        document.getElementById('worldMapImg').onload = function() {
            calculate(true);
            toggleLive();
        };
    </script>
</body>
</html>
